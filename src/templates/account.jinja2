{% extends "base_static.jinja2" %}

{% block title %}
    {% trans %}Account settings{% endtrans %}
{% endblock title %}

{% block content %}

{{ page_heading(gettext('Account settings')) }}

<p>{% trans name=user.username %}Logged in as: {{ name }}{% endtrans %}</p>

<h2>{% trans %}Last.fm scrobbling{% endtrans%}</h2>
<p>
    {% if lastfm_enabled %}
        {% if lastfm_name %}
            {% trans name=lastfm_name %}Connected to last.fm account: {{ name }}{% endtrans%}<br>
            <form action="/lastfm_disconnect" method="POST">
                <input type="hidden" name="csrf" value="{{ csrf_token }}">
                <input type="submit" value="{% trans %}Disconnect last.fm account{% endtrans %}">
            </form>
        {% else %}
            <a href="{{ lastfm_connect_url }}">{% trans %}Connect your last.fm account{% endtrans %}</a>
        {% endif %}
    {% else %}
        {% trans %}Last.fm integration is not available, because no API key is configured{% endtrans %}
    {% endif %}
</p>

<h2>{% trans %}Sessions{% endtrans%}</h2>
<table class="table">
    <thead>
        <tr>
            <th>{% trans %}Login date{% endtrans %}</th>
            <th>{% trans %}Last used{% endtrans %}</th>
            <th>{% trans %}Device{% endtrans %}</th>
            <th>{% trans %}IP address{% endtrans %}</th>
        </tr>
    </thead>
    <tbody>
        {% for session in sessions %}
            <tr>
                <td>{{ session.creation_date }}</td>
                <td>{{ session.last_use_ago }}</td>
                <td>{{ session.last_device }}</td>
                <td>{{ session.remote_address }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<h2>{% trans %}Change password{% endtrans %}</h2>
<form method="POST" action="/change_password_form">
    <input type="hidden" value="{{ csrf_token }}" name="csrf_token">
    {% trans %}Current password{% endtrans %}<br>
    <input type="password" value="" name="current_password"><br>
    {% trans %}New password{% endtrans %}<br>
    <input type="password" value="" name="new_password"><br>
    {% trans %}Repeat new password{% endtrans %}<br>
    <input type="password" value="" name="repeat_new_password"><br>
    <input type="submit" value="{% trans %}Change password{% endtrans %}">
</form>

<h2>{% trans %}Change nickname{% endtrans %}</h2>
<form method="POST" action="/change_nickname_form">
    <input type="hidden" value="{{ csrf_token }}" name="csrf_token">
    <input type="text" value="{{ user.nickname if user.nickname }}" name="nickname"><br>
    <input type="submit" value="{% trans %}Change nickname{% endtrans %}">
</form>

<h2>{% trans %}Change language{% endtrans %}</h2>
<form method="POST" action="/change_language_form">
    <input type="hidden" value="{{ csrf_token }}" name="csrf_token">
    <select name="language">
        <option value="" {% if not user.language %}selected{% endif %}>{% trans %}System language{% endtrans %}</option>
        {% for lang_code, lang_display in languages %}
            {% if lang_code == user.language %}
                <option value="{{ lang_code }}" selected>{{ lang_display }}</option>
            {% else %}
                <option value="{{ lang_code }}">{{ lang_display }}</option>
            {% endif %}
        {% endfor %}
    </select><br>
    <input type="submit" value="{% trans %}Change language{% endtrans %}">
</form>

{% endblock content %}
